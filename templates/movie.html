{% extends "base.html" %}
{% block title %}{{ movie.title }}{% endblock %}

{% block content %}
<div class="movie-detail">
    <a href="/" class="back-btn">← Back to Home</a>
    
    <div class="movie-header">
        <img src="{{ movie.poster_url }}" alt="{{ movie.title }} poster" class="detail-poster">
        <div class="movie-info">
            <h1>{{ movie.title }} <span class="year">({{ movie.year }})</span></h1>
            <p class="meta">{{ movie.genre }} • Directed by <strong>{{ movie.director }}</strong></p>
            
            <div class="rating-big">
                {% if movie.average_rating() > 0 %}
                    ⭐ {{ movie.average_rating() }}/5 ({{ movie.reviews|length }} reviews)
                {% else %}
                    <em>No reviews yet — be the first!</em>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="description">
        <h2>About</h2>
        <p>{{ movie.description or "No description available." }}</p>
    </div>

    {% if request.authorization and request.authorization.username == "admin" %}
<div class="reviews-section">
    <h2>Add Your Review</h2>
    <form method="POST" action="{{ url_for('add_review', movie_id=movie.id) }}" class="review-form">
        <textarea name="text" placeholder="Your thoughts on {{ movie.title }}..." required rows="4"></textarea>
        
        <div class="rating-input">
            <label>Rating:</label>
            {% for i in range(5,0,-1) %}
                <input type="radio" name="rating" value="{{ i }}" id="star{{ i }}" required>
                <label for="star{{ i }}">★</label>
            {% endfor %}
        </div>
        
        <button type="submit" class="submit-review">Save Review</button>
    </form>
</div>
{% endif %}
</div>
{% endblock %}
